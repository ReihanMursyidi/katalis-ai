<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduPlan AI - Asisten Cerdas Para Pengajar</title>

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script src="mapel.js"></script>
    <style>
        .text-yellow-500 {
            color: #fbbf24 !important;
        }

        .text-green-500 {
            color: #22c55e !important;
        }

        .text-slate-400 {
            color: #94a3b8 !important;
        }
    </style>
</head>
<body>

    <div id="auth-modal" class="modal-overlay hidden">
        <div class="modal-box">
            <button class="modal-close" onclick="toggleAuthModal(false)"><i class="fa-solid fa-times"></i></button>
            
            <div class="auth-tabs">
                <div class="auth-tab active" id="tab-login" onclick="switchAuthMode('login')">Masuk</div>
                <div class="auth-tab" id="tab-register" onclick="switchAuthMode('register')">Daftar</div>
            </div>

            <form id="form-login" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="login_email" required placeholder="nama@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="login_password" required placeholder="********">
                </div>
                <button type="submit" class="btn-submit">Masuk</button>
            </form>

            <form id="form-register" class="hidden" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Nama Lengkap</label>
                    <input type="text" id="reg_name" required placeholder="Pak Budi">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="reg_email" required placeholder="nama@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="reg_password" required placeholder="Buat password aman">
                </div>
                <button type="submit" class="btn-submit btn-purple">Daftar Sekarang</button>
            </form>
        </div>
    </div>

    <div class="main-container">
        <aside class="input-panel">
            <header>
                <div class="logo">
                    <i class="fa-solid fa-brain text-blue" style="margin-right: 0.5rem;"></i>EduPlan<span class="text-blue">AI</span>
                </div>
                <p class="subtitle">Membantu Produktivitas Para Pengajar di Indonesia</p>

                <div class="user-section">
                    <div id="guest-view" class="guest-view" style="padding: 20px;">
                        <div style="width: 50px; height: 50px; background: #334155; border-radius: 50%; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center;">
                            <i class="fa-solid fa-user-lock text-slate-400"></i>
                        </div>
                        <p style="font-size: 0.8rem; color: #94a3b8; margin-bottom: 15px;">
                            Akses fitur lengkap & simpan progress Anda.
                        </p>
                        <button class="btn-login-nav" onclick="toggleAuthModal(true)">
                            Masuk Akun
                        </button>
                    </div>

                    <div id="user-view" class="user-view">
                        <div class="profile-header">
                            <div class="avatar-circle" id="user-avatar">U</div>
                            
                            <div class="user-info">
                                <span class="user-name" id="display-name">User</span>
                                <span class="user-role">
                                    <i class="fa-solid fa-circle-check text-green-500" style="font-size: 0.6rem;"></i> Basic Plan
                                </span>
                            </div>

                            <button class="btn-logout-icon" onclick="handleLogout()" title="Keluar">
                                <i class="fa-solid fa-arrow-right-from-bracket"></i>
                            </button>
                        </div>

                        <div class="profile-stats">
                            <span class="coin-label">Sisa Koin Anda</span>
                            <div class="coin-badge">
                                <i class="fa-solid fa-coins text-yellow-500"></i>
                                <span class="coin-count" id="display-coins">0</span>
                            </div>
                            
                        </div>
                    </div>
                </div>

                <div class="tab-nav">
                    <button class="tab-btn active" onclick="switchTab('rpp')">
                        <i class="fa-solid fa-book-open"></i> Modul Ajar
                    </button>
                    <button class="tab-btn" onclick="switchTab('quiz')">
                        <i class="fa-solid fa-list-check"></i> Kuis Soal
                    </button>
                    <button class="tab-btn" onclick="switchTab('rapor')" style="position: relative;">
                        <i class="fa-solid fa-pen-nib"></i> Rapor
                    </button>
                </div>
            </header>

            <form id="form-rpp" class="active-form">
                <p class="section-label">Konfigurasi RPP</p>
                <div class="form-row">
                    <div class="form-group half">
                        <label>Jenjang</label>
                        <select id="rpp_jenjang" onchange="updateKelas('rpp')">
                            <option disabled selected>Pilih Jenjang...</option>
                            <option value="SD">SD</option>
                            <option value="SMP">SMP</option>
                            <option value="SMA">SMA</option>
                        </select>
                    </div>
                    <div class="form-group half">
                        <label>Kelas</label>
                        <select id="rpp_kelas">
                            <option disabled selected>Pilih Kelas</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Mata Pelajaran</label>
                    <select id="rpp_mapel" onchange="checkMapelLainnya('rpp')">
                        <option disabled selected>Pilih Jenjang & Kelas dulu...</option>
                    </select>
                    
                    <input type="text" id="rpp_mapel_manual" class="hidden" placeholder="Tulis nama mata pelajaran..." style="margin-top: 10px;">
                </div>

                <div class="form-group">
                    <label>Materi Utama</label>
                    <input type="text" id="rpp_materi" placeholder="Cth: Ekosistem" min="10" max="50">
                </div>

                <div class="form-group">
                    <label>Capaian Pembelajaran</label>
                    <textarea id="rpp_capaian" rows="2" placeholder="Siswa memahami..." min="10" max="100"></textarea>
                </div>

                <div class="form-group">
                    <label>Durasi</label>
                    <input type="text" id="rpp_durasi" placeholder="Cth: 2 x 45 Menit" min="1" max="20">
                </div>

                <button type="button" onclick="generateRPP()" class="btn-submit">
                    <i class="fa-solid fa-wand-magic-sparkles"></i> Buat Modul Ajar (10 Koin)
                </button>
            </form>

            <form id="form-quiz" class="hidden-form">
                <p class="section-label">Konfigurasi Soal</p>
                
                <div class="form-row">
                    <div class="form-group half">
                        <label>Jenjang</label>
                        <select id="quiz_jenjang" onchange="updateKelas('quiz')">
                            <option value="" disabled selected>Pilih Jenjang...</option>
                            <option value="SD">SD</option>
                            <option value="SMP">SMP</option>
                            <option value="SMA">SMA</option>
                        </select>
                    </div>
                    <div class="form-group half">
                        <label>Kelas</label>
                        <select id="quiz_kelas"><option disabled selected>-</option></select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Mata Pelajaran</label>
                    <select id="quiz_mapel" onchange="checkMapelLainnya('quiz')">
                        <option disabled selected>Pilih Jenjang & Kelas dulu...</option>
                    </select>
                    <input type="text" id="quiz_mapel_manual" class="hidden" placeholder="Tulis mapel..." style="margin-top: 10px;">
                </div>

                <div class="form-group">
                    <label>Topik Soal</label>
                    <input type="text" id="quiz_topik" placeholder="Cth: Pecahan Desimal" min="5" max="50">
                </div>

                <div class="form-row">
                    <div class="form-group half">
                        <label>Jumlah Soal</label>
                        <input type="number" id="quiz_jumlah" value="5" min="1" max="20" oninput="if(value > 20) value=20; if(value < 1) value=1;">
                    </div>
                    <div class="form-group half">
                        <label>Jenis Soal</label>
                        <select id="quiz_jenis">
                            <option value="Pilihan Ganda">Pilihan Ganda</option>
                            <option value="Essay">Essay / Uraian</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Tingkat Kesulitan</label>
                    <select id="quiz_kesulitan">
                        <option value="Mudah">Mudah (LOTS)</option>
                        <option value="Sedang">Sedang (MOTS)</option>
                        <option value="Sulit">Sulit (HOTS)</option>
                    </select>
                </div>

                <button type="button" onclick="generateQuiz()" class="btn-submit btn-purple">
                    <i class="fa-solid fa-puzzle-piece"></i> Buat Soal (10 Koin)
                </button>
            </form>

            
            <form id="form-rapor" class="hidden-form">
                <p class="section-label">Generator Narasi Rapor</p>

                <div class="form-group">
                    <label>Nama Siswa</label>
                    <input type="text" id="rapor_nama" placeholder="Cth: Budi Santoso">
                </div>

                <div class="form-row">
                    <div class="form-group half">
                        <label>Kelas</label>
                        <input type="text" id="rapor_kelas" placeholder="X-A">
                    </div>
                    <div class="form-group half">
                        <label>Nilai Rata-rata</label>
                        <input type="text" id="rapor_nilai" placeholder="85,5" inputmode="decimal">
                    </div>
                </div>

                <div class="form-group">
                    <label>Sikap / Karakter Utama</label>
                    <select id="rapor_sikap">
                        <option value="Sangat Rajin & Aktif">Sangat Rajin & Aktif</option>
                        <option value="Sopan namun Pendiam">Sopan namun Pendiam</option>
                        <option value="Perlu Bimbingan Fokus">Perlu Bimbingan Fokus</option>
                        <option value="Sering Terlambat">Sering Terlambat</option>
                        <option value="Memiliki Jiwa Kepemimpinan">Memiliki Jiwa Kepemimpinan</option>
                        <option value="Lainnya">Lainnya (Tulis di catatan)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Catatan Khusus (Opsional)</label>
                    <textarea id="rapor_catatan" rows="2" placeholder="Cth: Sering tidak mengerjakan PR, tapi jago olahraga..."></textarea>
                </div>

                <button type="button" onclick="generateRapor()" class="btn-submit btn-purple">
                    <i class="fa-solid fa-feather"></i> Buat Narasi (30 Koin)
                </button>
            </form>
            <div style="margin-top: auto; padding-top: 20px; border-top: 1px solid #334155; text-align: center;">
                <p style="font-size: 0.75rem; color: #94a3b8;">
                    Powered by 
                    <span style="font-weight: 600; background: linear-gradient(to right, #2D79EF, #EC5360); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                        Google Gemini </i>
                    </span>
                </p>
            </div>
        </aside>

        <main class="result-panel">
            <div id="loading-overlay" class="hidden">
                <div class="spinner"></div>
                <p style="color: var(--text-muted);">Sedang berpikir...</p>
            </div>

            <div id="welcome-screen" class="placeholder-content">
                <i class="fa-solid fa-robot big-icon"></i>
                <h2>Halo, Pengajar Hebat!</h2>
                <p>Silakan isi formulir di panel kiri untuk mulai.</p>
            </div>

            <div id="result-content" class="result-box hidden">
                <div class="result-header">
                    <h3 id="result-title"><i class="fa-solid fa-check-circle text-blue"></i>ðŸ“„ Hasil Generator</h3>
                    <button class="btn-copy" onclick="copyToClipboard()">
                        <i class="fa-regular fa-copy"></i> Salin
                    </button>
                </div>
                <div id="markdown-output" class="markdown-body"></div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>